<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head><script src="../assets/js/color-modes.js"></script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.122.0">
    <title>Ganeo</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.3/examples/navbar-static/">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
    <link href="assets/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>

      .p {
        color: "blue"
      }

      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

      .b-example-divider {
        width: 100%;
        height: 3rem;
        background-color: rgba(0, 0, 0, .1);
        border: solid rgba(0, 0, 0, .15);
        border-width: 1px 0;
        box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
      }

      .b-example-vr {
        flex-shrink: 0;
        width: 1.5rem;
        height: 100vh;
      }

      .bi {
        vertical-align: -.125em;
        fill: currentColor;
      }

      .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
      }

      .nav-scroller .nav {
        display: flex;
        flex-wrap: nowrap;
        padding-bottom: 1rem;
        margin-top: -1px;
        overflow-x: auto;
        text-align: center;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }

      .btn-bd-primary {
        --bd-violet-bg: #712cf9;
        --bd-violet-rgb: 112.520718, 44.062154, 249.437846;

        --bs-btn-font-weight: 600;
        --bs-btn-color: var(--bs-white);
        --bs-btn-bg: var(--bd-violet-bg);
        --bs-btn-border-color: var(--bd-violet-bg);
        --bs-btn-hover-color: var(--bs-white);
        --bs-btn-hover-bg: #6528e0;
        --bs-btn-hover-border-color: #6528e0;
        --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
        --bs-btn-active-color: var(--bs-btn-hover-color);
        --bs-btn-active-bg: #5a23c8;
        --bs-btn-active-border-color: #5a23c8;
      }

      .bd-mode-toggle {
        z-index: 1500;
      }

      .bd-mode-toggle .dropdown-menu .active .bi {
        display: block !important;
      }
    </style>

    
  <!-- Custom styles for this template -->
  <link href="navbar-static.css" rel="stylesheet">
  </head>
  <body>
    <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
      <symbol id="check2" viewBox="0 0 16 16">
        <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
      </symbol>
      <symbol id="circle-half" viewBox="0 0 16 16">
        <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
      </symbol>
      <symbol id="moon-stars-fill" viewBox="0 0 16 16">
        <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
      </symbol>
      <symbol id="sun-fill" viewBox="0 0 16 16">
        <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
      </symbol>
    </svg>

    <div class="dropdown position-fixed bottom-0 end-0 mb-3 me-3 bd-mode-toggle">
      <button class="btn btn-bd-primary py-2 dropdown-toggle d-flex align-items-center"
              id="bd-theme"
              type="button"
              aria-expanded="false"
              data-bs-toggle="dropdown"
              aria-label="Toggle theme (auto)">
        <svg class="bi my-1 theme-icon-active" width="1em" height="1em"><use href="#circle-half"></use></svg>
        <span class="visually-hidden" id="bd-theme-text">Toggle theme</span>
      </button>
      <ul class="dropdown-menu dropdown-menu-end shadow" aria-labelledby="bd-theme-text">
        <li>
          <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
            <svg class="bi me-2 opacity-50" width="1em" height="1em"><use href="#sun-fill"></use></svg>
            Light
            <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
          </button>
        </li>
        <li>
          <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
            <svg class="bi me-2 opacity-50" width="1em" height="1em"><use href="#moon-stars-fill"></use></svg>
            Dark
            <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
          </button>
        </li>
        <li>
          <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
            <svg class="bi me-2 opacity-50" width="1em" height="1em"><use href="#circle-half"></use></svg>
            Auto
            <svg class="bi ms-auto d-none" width="1em" height="1em"><use href="#check2"></use></svg>
          </button>
        </li>
      </ul>
    </div>

    
<nav class="navbar navbar-expand-md navbar-dark bg-dark mb-4">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Ganeo</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav me-auto mb-2 mb-md-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Blog</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="livros.html">Livros</a>
        </li>
        <li class="nav-item"></li>
          <a class="nav-link" href="produtos.html">Produtos</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="sobre.html">Sobre</a>
        </li>
      </ul>
      <form class="d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success" type="submit">Search</button>
      </form>
    </div>
  </div>
</nav>

<!-- Page content-->
<div class="container mt-5">
  <div class="row">
    <div class="col-lg-8">
      <!-- Post header-->
      <header class="mb-4">
        <!-- Post title-->
        <h1 class="fw-bolder mb-1">Embedding Models</h1>
        <!-- Post meta content-->
        <div class="text-muted fst-italic mb-2">18 de Setembro de 2024 por Giseldo Neo</div>
        <!-- Post categories-->
        <a class="badge bg-secondary text-decoration-none link-light" href="#!">Aprendizagem de Máquina</a>
        <a class="badge bg-secondary text-decoration-none link-light" href="#!">Regressão Linear</a>
    </header>

        <!-- Post content-->
        <article>
          <section class="mb-5">
    
    <p class="fs-5 mb-4">Este artigo é inpirado e uma tradução livre do post do <a
    href="https://ollama.com/blog/embedding-models">Ollama.</a></p>

    <p class="fs-5 mb-4">Modelos de <em>Embedding</em> são modelos treinados para gerar
    vetores de <em>embeddings</em>.</p>

    <p class="fs-5 mb-4">Esses vetores são números que representam semânticamente o
    significado de uma determinada porção do texto.</p>

    <p class="fs-5 mb-4">Um vetor (em inglês <em>array</em>) é uma estrutura de dados que
    armazena uma coleção de elementos, normalmente todos do mesmo tipo, em
    posições contíguas de memória. Cada elemento em um vetor é acessado por
    um índice ou posição, que começa em 0 na maioria das linguagens de
    programação. Vetores são usados para armazenar várias variáveis sob um
    único nome, o que permite organizar dados de forma eficiente.</p>
    <p class="fs-5 mb-4">Por exemplo, em uma linguagem como Python, um array pode ser
    representado como uma lista:</p>
    <div class="sourceCode" id="cb1"><pre
    class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
    <span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>numeros <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span></code></pre></div>
    <p class="fs-5 mb-4">Com essa representação em forma de</p>
  </section>
  </article>
            
</div>
</div>

    <div class="row">
        <div class="col-lg-8">
            <!-- Post content-->
            <article>
                <!-- Post header-->
                <header class="mb-4">
                    <!-- Post title-->
                    <h1 class="fw-bolder mb-1">Regressão Linear. Normalidade dos resíduos!</h1>
                    <!-- Post meta content-->
                    <div class="text-muted fst-italic mb-2">18 de Setembro de 2024 pors Giseldo Neo</div>
                    <!-- Post categories-->
                    <a class="badge bg-secondary text-decoration-none link-light" href="#!">Aprendizagem de Máquina</a>
                    <a class="badge bg-secondary text-decoration-none link-light" href="#!">Regressão Linear</a>
                </header>
                <!-- Post content-->
                <section class="mb-5">
                    <p class="fs-5 mb-4"class="fs-5 mb-4">A Regressão linear é uma técnica estatística que tenta modelar a relação entre duas ou mais variáveis usando uma linha reta. É uma ferramenta poderosa para prever valores de uma variável dependente (a que você está tentando prever) com base nos valores de uma ou mais variáveis independentes (aquelas que você usa para fazer a previsão).</p>
                    <p class="fs-5 mb-4">Imagine que você quer saber se existe uma relação entre o número de horas que um estudante estuda e a nota que ele tira em um teste. Você pode usar a regressão linear para verificar se existe uma relação linear entre essas duas variáveis e prever a nota do estudante com base no número de horas que ele estuda.</p>    
                    <p class="fs-5 mb-4">O código a seguir cria os dados necessários e apresenta um gráfico de pontos da relação entre as duas variáveis, $x$ a variável dependente e $y$ a variável independente.</p>
                    <p class="fs-5 mb-4">Primeiro vamos instalar as dependências necessárias.</p>
                    
```
!pip install numpy matplotlib statsmodels seaborn
```

<p class="fs-5 mb-4"></p>Em seguida o código Python</p>

```Python
# bibliotecas utilizadas
import numpy as np
import matplotlib.pyplot as plt

# criação do conjunto de dados
np.random.seed(42)
x = np.random.rand(100)
y = 2 * x + 1 + np.random.normal(0, 0.2, 100)

# gráfico
plt.scatter(x, y)
plt.xlabel('x')
plt.ylabel('y')
plt.title('Gráfico de Dispersão')
plt.show()
```

<figure class="mb-4"><img class="img-fluid rounded" src="https://dummyimage.com/900x400/ced4da/6c757d.jpg" alt="..." /></figure>
![alt text](image-1.png)

<p class="fs-5 mb-4">Os dados foram gerados aleatóriamente de forma que exista uma relação linear entre as variaveis. Visualmente podemos perceber que parece que existe uma relação linear.</p>

<p class="fs-5 mb-4"># Normalidade dos Resíduos</p>

<p class="fs-5 mb-4">A normalidade dos resíduos é uma das suposições da regressão linear. Os resíduos são as diferenças entre os valores observados e os valores previstos pelo modelo de regressão.  A fórmula para calcular o resíduo é apresentada a seguir.</p>

$Resíduo = y_i - \hat{y}_i$

<p class="fs-5 mb-4">onde:</p>

<p class="fs-5 mb-4">* $y_i$ é o valor observado da variável dependente</p>

<p class="fs-5 mb-4">* $\hat{y}_i$ é o valor previsto pelo modelo de regressão</p>

<p class="fs-5 mb-4">Para verificar os resíduos podemos utilizar dois tipos de gráficos: </p>

<p class="fs-5 mb-4">* Um histograma dos resíduos </p>
<p class="fs-5 mb-4">* Um QQ plot dos resíduos</p>

<p class="fs-5 mb-4"></p>Vamos primeiro criar um modelo de regressão e exibir os erros. Utilizaremos todos os dados para o treino, não separaremos estes dados entre treino e teste pois nosso objetivo não é verificar o quão bom esse modelo se ajusta aos dados e sim simplesmente verificar a normalidade dos resíduos. </p>

```Python
import numpy as np
from sklearn.linear_model import LinearRegression

np.random.seed(42)
x = np.random.rand(100)
y = 2 * x + 1 + np.random.normal(0, 0.2, 100)
modelo = LinearRegression()
modelo.fit(x.reshape(-1, 1), y)
erros = y - modelo.predict(x.reshape(-1, 1))
erros
```

<p class="fs-5 mb-4">A saída é uma lista com o erro de cada uma das observações.</p>

```
array([ 0.00883089, -0.0153981 ,  ....,  0.13233854])
```

<p class="fs-5 mb-4">## Histograma dos resíduos</p>

<p class="fs-5 mb-4">Um histograma ser utilizado para analisar a normalidade dos resíduos.</p>

```Python
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sn
from sklearn.linear_model import LinearRegression

np.random.seed(42)
x = np.random.rand(100)
y = 2 * x + 1 + np.random.normal(0, 0.2, 100)
modelo = LinearRegression()
modelo.fit(x.reshape(-1, 1), y)
erros = y - modelo.predict(x.reshape(-1, 1))
sn.histplot(erros, bins=20, kde=True)
plt.xlabel('Erros')
plt.ylabel('Frequência')
plt.title('Histograma dos Erros')
plt.show()
```
<figure class="mb-4"><img class="img-fluid rounded" src="https://dummyimage.com/900x400/ced4da/6c757d.jpg" alt="..." /></figure>
![alt text](image-2.png)

<p class="fs-5 mb-4">É possível perceber visualmente que o histograma dos resíduos segue uma distribuição parecida com a distribuição normal.</p>

## QQ Plot

<p class="fs-5 mb-4">Um QQ Plot (Quantile-Quantile Plot) é uma ferramenta gráfica usada para comparar a distribuição de um conjunto de dados com uma distribuição teórica específica, geralmente a distribuição normal. No contexto de regressão linear, um QQ Plot dos resíduos é útil para verificar a suposição de normalidade dos erros.</p>

```Python
import numpy as np
import statsmodels.api as sm
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt

np.random.seed(42)
x = np.random.rand(100)
y = 2 * x + 1 + np.random.normal(0, 0.2, 100)
modelo = LinearRegression()
modelo.fit(x.reshape(-1, 1), y)
erros = y - modelo.predict(x.reshape(-1, 1))
sm.qqplot(erros, line='45', fit=True)
plt.show()
```
<figure class="mb-4"><img class="img-fluid rounded" src="https://dummyimage.com/900x400/ced4da/6c757d.jpg" alt="..." /></figure>
![alt text](image-3.png)

                    <!--<h2 class="fw-bolder mb-4 mt-5">I have odd cosmic thoughts every day</h2>-->
                    
                </section>
            </article>
            
        </div>
    </div>
</div>

<script src="assets/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
